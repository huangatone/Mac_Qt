<!DOCTYPE html>
<html>
<head>
<title></title>
<style type="text/css">
        body
        {
        margin:0;
        padding:0;
        }
        #div1
        {
        width:45%;
        float:left;
        height:100%;
        position:absolute;
        }
        #div2
        {
        width:55%;
        background-color:#000022;
        float:left;
        height:100%;
        position:absolute;
        }
        #map {
        height: 60%;
        width: 100%
        }
        #splitter
        {
        width:10px;
        background-color:#002200;
        float:left;
        height:100%;
        position:absolute;
        cursor:w-resize;
        }


</style>
<script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js"></script>
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCQMC-XDcbgfPtySwq9J4AL2uG8tZXuTUo&callback=initMap"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/xlsx.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/jszip.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/xlsx.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.10.8/xlsx.full.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.6/angular.min.js"></script>
<script >
        var splitter,cont1,cont2;
        var last_x,window_width;
        var map ;
        var markers = [];

        function init()
        {
            window_width=window.innerWidth;
        	splitter=document.getElementById("splitter");
        	cont1=document.getElementById("div1");
        	cont2=document.getElementById("div2");
        	var dx=cont1.clientWidth;
        	splitter.style.marginLeft=dx+"px";
        	dx+=splitter.clientWidth;
        	cont2.style.marginLeft=dx+"px";
        	dx=window_width-dx;
        	cont2.style.width=dx+"px";
        	splitter.addEventListener("mousedown",spMouseDown);

        }

        function spMouseDown(e)
        {
                splitter.removeEventListener("mousedown",spMouseDown);
        	window.addEventListener("mousemove",spMouseMove);
        	window.addEventListener("mouseup",spMouseUp);
        	last_x=e.clientX;
        }

        function spMouseUp(e)
        {
            window.removeEventListener("mousemove",spMouseMove);
        	window.removeEventListener("mouseup",spMouseUp);
        	splitter.addEventListener("mousedown",spMouseDown);
        	resetPosition(last_x);
        }

        function spMouseMove(e)
        {
                resetPosition(e.clientX);
        }

        function resetPosition(nowX)
        {
            var dx=nowX-last_x;
        	dx+=cont1.clientWidth;
        	cont1.style.width=dx+"px";
        	splitter.style.marginLeft=dx+"px";
        	dx+=splitter.clientWidth;
        	cont2.style.marginLeft=dx+"px";
        	dx=window_width-dx;
        	cont2.style.width=dx+"px";
        	last_x=nowX;
        }

        function initMap() 
        {
            map = new google.maps.Map(document.getElementById('div2'), {
        	zoom: 3,
        	center: {lat: -28.024, lng: 140.887}
        	});
        }

        function handleClick(cb) 
        {
            display("Clicked, new value = " + cb.checked + cb.value);

            var latLng = new google.maps.LatLng(  -33.865427,  151.196123);
            var image = 'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png';
            var marker = new google.maps.Marker({
                    position: latLng,
                    map: map,
                    label: cb.value,
                    icon: image
                  });

        }

    function display(msg) 
    {
      var p = document.createElement('p');
      p.innerHTML = msg;
      cont1.appendChild(p);
    }

    function ExcelExport(event) 
    {

   
    var group = new Array();
    var index = 0;
    var input = event.target;
    var reader = new FileReader();
    reader.onload = function()
    {
        var fileData = reader.result;
        var wb = XLSX.read(fileData, {type : 'binary'});

        wb.SheetNames.forEach(function(sheetName){
        var rowObj =XLSX.utils.sheet_to_row_object_array(wb.Sheets[sheetName]);
        var jsonObj = JSON.stringify(rowObj);
        
        JSON.parse(jsonObj, (key, value) => {
              console.log(key); // log the current property name, the last is "".
              if(key == "col1")
              {
                   if (group.includes(value) == false)
                   {
                   // console.log("new group");
                        group.push(value);

                        //var p = document.createElement('input');
                        //p.type="checkbox";                        
                        //p.value = value;
                       // cont1.appendChild(p);
                        //p.onclick =handleClick(p);

                        var tt = document.createElement('p');
                        tt.innerHTML = " <input type='checkbox' onclick='handleClick(this)' value= ' " + value + "' />" + value;
                        cont1.appendChild(tt);


                    }
              }
              console.log(value);
              console.log('---------------\n');
              return value;     // return the unchanged property value.
            });
        console.log(jsonObj)
        console.log('---------------\n');
        })

         console.log('items size = ' + group.length);
        for(var i= 0, l = group.length; i< l; i++)
        {
           console.log( 'item  = ' + group[i]);
        }
    };

    var res = reader.readAsBinaryString(input.files[0]);

    console.log('---------------\n');
   

  
}


        function setMapOnAll(map) 
        {
                for (var i = 0; i < markers.length; i++)
                 {
                  markers[i].setMap(map);
                }
        }

      // Removes the markers from the map, but keeps them in the array.
      function clearMarkers() {
        setMapOnAll(null);
      }

</script>
</head>
<body onload="init();">
        <div id="div1">
        <form >
          <input type="checkbox" name="vehicle" value="Bike" onclick='handleClick(this);'> I have a bike<br>
          <input type="checkbox" name="vehicle" value="Car" checked onclick='handleClick(this);'> I have a car<br>
          <input type="submit" value="Submit">
          <input type="file" id="file" ng-model="csvFile"  
    onchange='ExcelExport(event)'/>
        </form>
        </div>
        <div id="splitter"></div>
        <div id="div2"></div>
<script type="text/javascript">

</script>
</body>
</html>>


